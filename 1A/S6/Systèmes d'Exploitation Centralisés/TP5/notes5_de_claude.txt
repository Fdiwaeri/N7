# Notes TP5 - Tubes (Pipes)

## 1. Principes de base des tubes (pipes)
- Un tube est un canal de communication unidirectionnel entre deux processus
- Créé avec la fonction `pipe(int filedes[2])`
- filedes[0] = extrémité de lecture
- filedes[1] = extrémité d'écriture
- Le processus écrivain met des données d'un côté, le processus lecteur les récupère de l'autre

## 2. Exercices de manipulation (tube1.c - tube5.c)

### tube1.c
- Le père crée un fils puis un tube
- Le père écrit un entier dans le tube
- Le fils lit l'entier et l'affiche

### tube2.c
- Le père crée un tube, écrit un entier
- Puis crée un fils qui lit et affiche cet entier

### tube3.c
- Le père crée un tube puis un fils
- Le père écrit plusieurs entiers puis fait pause()
- Le fils lit en boucle jusqu'à ce que read() retourne ≤ 0

### tube4.c
- Comme tube3.c mais avec sleep(10) au lieu de pause()
- Permet d'observer différentes situations de synchronisation

### tube5.c
- Test de la capacité des tampons de tube
- Le père écrit en boucle dans le tube
- Le fils lit après avoir reçu un signal
- Permet d'évaluer la taille du tampon d'un tube

## 3. Implémentation dans le minishell

### Étape 16 - Tubes simples
- Permettre l'exécution de deux commandes reliées par un pipe
- Exemple: `ls | wc -l`
- Il faut créer un tube entre les deux processus fils
- Rediriger la sortie standard du premier vers l'entrée du tube
- Rediriger l'entrée standard du second vers la sortie du tube

### Étape 17 - Pipelines
- Extension pour supporter une chaîne de commandes avec plusieurs pipes
- Exemple: `cat fichier | grep motif | wc -l`
- Nécessite la création de plusieurs tubes et la redirection appropriée

## Points importants à retenir
- Fermer les descripteurs non utilisés dans chaque processus
- Les tubes sont unidirectionnels
- Si tous les descripteurs d'écriture sont fermés, read() renvoie 0 (EOF)
- Si on écrit dans un tube dont tous les descripteurs de lecture sont fermés, SIGPIPE est généré
- La taille du tampon est généralement de 64Ko
